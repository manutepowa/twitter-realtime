angular.module("analyticApp").filter("unique",function(){return function(a,b){var c=[],d=[];return angular.forEach(a,function(a){var e=a[b];-1===d.indexOf(e)&&(d.push(e),c.push(a))}),c}}).factory("moreInfo",function(){var a={};return a.getMoreInfo=function(b,c){for(var d=0;d<=b.length-1;d++)if(b[d].id_str===c){a.info=b[d];break}},a}).controller("streamCrtl",["$scope","mySocket","moreInfo","comprobarConexion","$interval",function(a,b,c,d,e){a.bienvenida="Stream",a.data=[],a.bool=1,b.on("debug",function(b){a.debug=b}),a.emitir=function(){a.data=[],a.media=[],a.moreInf,a.imageInfo,a.topHashtag=[],a.bool=0,a.initTimer(),d.set(!0),a.loader=1,b.emit("inicializar"),b.emit("startStream",{parametro:a.text}),b.on("twet",function(b){a.realTime=b,b.retweeted_status?a.data.push({id:b.user.screen_name,id_str:b.id_str,t:b.text,image:b.user.profile_image_url,zona:b.user.time_zone,url:b.entities.urls,hashtag:b.entities.hashtags,retweeted_status:b.retweeted_status.user.screen_name}):a.data.push({id:b.user.screen_name,id_str:b.id_str,t:b.text,image:b.user.profile_image_url,zona:b.user.time_zone,url:b.entities.urls,hashtag:b.entities.hashtags,retweeted_status:!1}),b.entities.media&&a.media.push({foto:b.entities.media[0].media_url+":thumb",url:b.entities.media[0].display_url})}),b.on("streamHashTag",function(b){a.topHashtag=b})},a.openModal=function(b){c.getMoreInfo(a.data,b),a.moreInf=c.info,a.imageInfo=a.moreInf.image.replace("normal","bigger"),$("#modalInfoTweet").modal("show")},a.detener=function(){d.set(!1),a.bool=1,angular.isDefined(a.timer)&&(a.contador=0,e.cancel(a.timer)),b.parar()},d.comprobar()&&a.detener(),a.initTimer=function(){a.contador=15,a.timer=e(function(){a.contador--,0==a.contador?a.detener():0!==a.data.length&&e.cancel(a.timer)},1e3)},$('[data-toggle="tooltip"]').tooltip(),a.tamHeight=$(window).height()-$("#submitStream").offset().top-70,$(".minHeigth").css({maxHeight:a.tamHeight,marginTop:"15px"}),$(".maxHeigth").css({minHeight:a.tamHeight-15,marginTop:"15px"}),$(".topHashtagHeight").css({height:a.tamHeight/2-8}),$(".topHashtagHeight").next().next().css({height:a.tamHeight/2-8}),$(".pCol").css({"min-height":$(window).height()-130+"px"}),$(".pCol form").addClass("midd"),$(".pCol form").on("submit",function(){$(this).removeClass("midd"),$(this).parent().removeClass("pCol"),$(this).parent().css({"min-height":0,transition:"all 0.2s ease"})})}]);